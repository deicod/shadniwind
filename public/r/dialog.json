{
  "name": "dialog",
  "type": "registry:ui",
  "title": "Dialog",
  "description": "A modal dialog that traps focus on web and locks scroll while open.",
  "registryDependencies": [
    "tokens",
    "portal",
    "overlay",
    "focus",
    "scroll-lock",
    "press"
  ],
  "files": [
    {
      "path": "components/ui/dialog.tsx",
      "content": "import * as React from \"react\"\nimport {\n  Platform,\n  Pressable,\n  type PressableProps,\n  type StyleProp,\n  Text,\n  type TextProps,\n  type TextStyle,\n  View,\n  type ViewProps,\n  type ViewStyle,\n} from \"react-native\"\nimport { StyleSheet } from \"react-native-unistyles\"\nimport { FocusScope } from \"../primitives/focus/index.js\"\nimport { DismissLayer } from \"../primitives/overlay/index.js\"\nimport { Portal } from \"../primitives/portal/index.js\"\nimport { composeEventHandlers } from \"../primitives/press/index.js\"\nimport { useScrollLock } from \"../primitives/scroll-lock/index.js\"\n\ntype DialogContextValue = {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  triggerRef: React.RefObject<View | null>\n  contentRef: React.RefObject<View | null>\n  titleId: string\n  descriptionId: string\n  modal: boolean\n}\n\nconst DialogContext = React.createContext<DialogContextValue | undefined>(\n  undefined,\n)\n\nfunction useDialog() {\n  const context = React.useContext(DialogContext)\n  if (!context) {\n    throw new Error(\"Dialog components must be used within a Dialog\")\n  }\n  return context\n}\n\nexport type DialogProps = {\n  children: React.ReactNode\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n  modal?: boolean\n}\n\nexport function Dialog({\n  children,\n  defaultOpen = false,\n  open: openProp,\n  onOpenChange,\n  modal = true,\n}: DialogProps) {\n  const [open, setOpen] = React.useState(defaultOpen)\n  const triggerRef = React.useRef<View>(null)\n  const contentRef = React.useRef<View>(null)\n  const titleId = React.useId()\n  const descriptionId = React.useId()\n\n  const isControlled = openProp !== undefined\n  const isOpen = isControlled ? openProp : open\n\n  const handleOpenChange = React.useCallback(\n    (nextOpen: boolean) => {\n      if (!isControlled) {\n        setOpen(nextOpen)\n      }\n      onOpenChange?.(nextOpen)\n    },\n    [isControlled, onOpenChange],\n  )\n\n  return (\n    <DialogContext.Provider\n      value={{\n        open: !!isOpen,\n        onOpenChange: handleOpenChange,\n        triggerRef,\n        contentRef,\n        titleId,\n        descriptionId,\n        modal,\n      }}\n    >\n      {children}\n    </DialogContext.Provider>\n  )\n}\n\nexport type DialogTriggerProps = PressableProps & { asChild?: boolean }\n\nexport const DialogTrigger = React.forwardRef<\n  React.ComponentRef<typeof Pressable>,\n  DialogTriggerProps\n>(({ children, asChild, onPress, ...props }, ref) => {\n  const { open, onOpenChange, triggerRef } = useDialog()\n\n  const handlePress = React.useCallback(\n    (event: unknown) => {\n      onOpenChange(!open)\n      // @ts-expect-error - React Native event type\n      onPress?.(event)\n    },\n    [open, onOpenChange, onPress],\n  )\n\n  React.useEffect(() => {\n    if (ref) {\n      if (typeof ref === \"function\") {\n        ref(triggerRef.current)\n      } else {\n        ;(ref as { current: View | null }).current = triggerRef.current\n      }\n    }\n  }, [ref, triggerRef])\n\n  if (asChild && React.isValidElement(children)) {\n    // biome-ignore lint/suspicious/noExplicitAny: Cloning logic\n    return React.cloneElement(children as React.ReactElement<any>, {\n      ref: triggerRef,\n      onPress: composeEventHandlers(\n        // @ts-expect-error - onPress check\n        children.props.onPress,\n        handlePress,\n      ),\n      role: Platform.OS === \"web\" ? \"button\" : undefined,\n      \"aria-expanded\": Platform.OS === \"web\" ? open : undefined,\n      \"aria-haspopup\": Platform.OS === \"web\" ? \"dialog\" : undefined,\n      accessibilityRole: \"button\",\n      accessibilityState: {\n        expanded: open,\n        disabled: props.disabled,\n      },\n      ...props,\n    })\n  }\n\n  return (\n    <Pressable\n      ref={triggerRef}\n      role={Platform.OS === \"web\" ? \"button\" : undefined}\n      aria-expanded={Platform.OS === \"web\" ? open : undefined}\n      aria-haspopup={Platform.OS === \"web\" ? \"dialog\" : undefined}\n      accessibilityRole=\"button\"\n      accessibilityState={{\n        expanded: open,\n        disabled: props.disabled,\n      }}\n      onPress={handlePress}\n      {...props}\n    >\n      {children}\n    </Pressable>\n  )\n})\n\nDialogTrigger.displayName = \"DialogTrigger\"\n\nexport type DialogCloseProps = PressableProps & { asChild?: boolean }\n\nexport const DialogClose = React.forwardRef<\n  React.ComponentRef<typeof Pressable>,\n  DialogCloseProps\n>(({ children, asChild, onPress, ...props }, ref) => {\n  const { onOpenChange } = useDialog()\n\n  const handlePress = React.useCallback(\n    (event: unknown) => {\n      onOpenChange(false)\n      // @ts-expect-error - React Native event type\n      onPress?.(event)\n    },\n    [onOpenChange, onPress],\n  )\n\n  if (asChild && React.isValidElement(children)) {\n    // biome-ignore lint/suspicious/noExplicitAny: Cloning logic\n    return React.cloneElement(children as React.ReactElement<any>, {\n      ref,\n      onPress: composeEventHandlers(\n        // @ts-expect-error - onPress check\n        children.props.onPress,\n        handlePress,\n      ),\n      accessibilityRole: \"button\",\n      ...props,\n    })\n  }\n\n  return (\n    <Pressable\n      ref={ref}\n      accessibilityRole=\"button\"\n      onPress={handlePress}\n      {...props}\n    >\n      {children}\n    </Pressable>\n  )\n})\n\nDialogClose.displayName = \"DialogClose\"\n\nexport type DialogContentSize = \"default\" | \"sm\" | \"lg\" | \"fullscreen\"\n\nexport type DialogContentProps = ViewProps & {\n  size?: DialogContentSize\n  overlayStyle?: StyleProp<ViewStyle>\n  dismissable?: boolean\n  onDismiss?: () => void\n}\n\nexport const DialogContent = React.forwardRef<View, DialogContentProps>(\n  (\n    {\n      children,\n      style,\n      overlayStyle,\n      size = \"default\",\n      dismissable,\n      onDismiss,\n      ...props\n    },\n    ref,\n  ) => {\n    const {\n      open,\n      onOpenChange,\n      contentRef,\n      titleId,\n      descriptionId,\n      modal,\n    } = useDialog()\n\n    useScrollLock(open && modal)\n    const variantStyles = styles.useVariants({\n      size: size === \"default\" ? undefined : size,\n    })\n\n    const handleDismiss = React.useCallback(() => {\n      onOpenChange(false)\n      onDismiss?.()\n    }, [onOpenChange, onDismiss])\n\n    const setContentRef = React.useCallback(\n      (node: View | null) => {\n        contentRef.current = node\n        if (typeof ref === \"function\") {\n          ref(node)\n        } else if (ref) {\n          ;(ref as { current: View | null }).current = node\n        }\n      },\n      [ref],\n    )\n\n    if (!open) return null\n\n    const isDismissable = dismissable ?? modal\n\n    return (\n      <Portal>\n        <DismissLayer\n          onDismiss={handleDismiss}\n          dismissable={isDismissable}\n          scrim={modal}\n          scrimStyle={[styles.overlay, overlayStyle]}\n        >\n          <FocusScope trapped={modal} loop={true} style={styles.center}>\n            <View\n              ref={setContentRef}\n              role={Platform.OS === \"web\" ? \"dialog\" : undefined}\n              aria-modal={Platform.OS === \"web\" ? modal : undefined}\n              aria-labelledby={Platform.OS === \"web\" ? titleId : undefined}\n              aria-describedby={Platform.OS === \"web\" ? descriptionId : undefined}\n              accessibilityRole={Platform.OS === \"web\" ? \"dialog\" : undefined}\n              accessibilityViewIsModal={modal}\n              style={[styles.content, variantStyles, style]}\n              {...props}\n            >\n              {children}\n            </View>\n          </FocusScope>\n        </DismissLayer>\n      </Portal>\n    )\n  },\n)\n\nDialogContent.displayName = \"DialogContent\"\n\nexport type DialogHeaderProps = ViewProps & {\n  style?: StyleProp<ViewStyle>\n}\n\nexport const DialogHeader = React.forwardRef<View, DialogHeaderProps>(\n  ({ style, ...props }, ref) => {\n    return <View ref={ref} style={[styles.header, style]} {...props} />\n  },\n)\n\nDialogHeader.displayName = \"DialogHeader\"\n\nexport type DialogFooterProps = ViewProps & {\n  style?: StyleProp<ViewStyle>\n}\n\nexport const DialogFooter = React.forwardRef<View, DialogFooterProps>(\n  ({ style, ...props }, ref) => {\n    return <View ref={ref} style={[styles.footer, style]} {...props} />\n  },\n)\n\nDialogFooter.displayName = \"DialogFooter\"\n\nexport type DialogTitleProps = TextProps & {\n  style?: StyleProp<TextStyle>\n}\n\nexport const DialogTitle = React.forwardRef<Text, DialogTitleProps>(\n  ({ style, ...props }, ref) => {\n    const { titleId } = useDialog()\n    return (\n      <Text ref={ref} nativeID={titleId} style={[styles.title, style]} {...props} />\n    )\n  },\n)\n\nDialogTitle.displayName = \"DialogTitle\"\n\nexport type DialogDescriptionProps = TextProps & {\n  style?: StyleProp<TextStyle>\n}\n\nexport const DialogDescription = React.forwardRef<Text, DialogDescriptionProps>(\n  ({ style, ...props }, ref) => {\n    const { descriptionId } = useDialog()\n    return (\n      <Text\n        ref={ref}\n        nativeID={descriptionId}\n        style={[styles.description, style]}\n        {...props}\n      />\n    )\n  },\n)\n\nDialogDescription.displayName = \"DialogDescription\"\n\nconst styles = StyleSheet.create((theme) => ({\n  overlay: {\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n  },\n  center: {\n    flex: 1,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: theme.spacing[4],\n  },\n  content: {\n    width: \"100%\",\n    maxWidth: 480,\n    borderRadius: theme.radius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n    padding: theme.spacing[6],\n    shadowColor: theme.colors.foreground,\n    shadowOpacity: 0.15,\n    shadowRadius: 10,\n    elevation: 4,\n    variants: {\n      size: {\n        sm: {\n          maxWidth: 360,\n        },\n        lg: {\n          maxWidth: 640,\n        },\n        fullscreen: {\n          maxWidth: \"100%\",\n          width: \"100%\",\n          height: \"100%\",\n          borderRadius: 0,\n          padding: theme.spacing[8],\n        },\n      },\n    },\n  },\n  header: {\n    marginBottom: theme.spacing[4],\n    gap: theme.spacing[1],\n  },\n  footer: {\n    marginTop: theme.spacing[4],\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n    gap: theme.spacing[2],\n    flexWrap: \"wrap\",\n  },\n  title: {\n    color: theme.colors.foreground,\n    fontFamily: theme.typography.families.sans,\n    fontSize: theme.typography.sizes.lg,\n    lineHeight: theme.typography.lineHeights.lg,\n    fontWeight: theme.typography.weights.semibold,\n  },\n  description: {\n    color: theme.colors.mutedForeground,\n    fontFamily: theme.typography.families.sans,\n    fontSize: theme.typography.sizes.sm,\n    lineHeight: theme.typography.lineHeights.md,\n  },\n}))\n",
      "type": "registry:ui"
    }
  ]
}
