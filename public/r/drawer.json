{
  "name": "drawer",
  "type": "registry:ui",
  "title": "Drawer",
  "description": "A modal drawer that slides in from the edge of the screen.",
  "registryDependencies": [
    "tokens",
    "portal",
    "overlay",
    "focus",
    "scroll-lock",
    "press"
  ],
  "files": [
    {
      "path": "components/ui/drawer.tsx",
      "content": "import * as React from \"react\"\nimport {\n  Animated,\n  Easing,\n  Platform,\n  Pressable,\n  type PressableProps,\n  type StyleProp,\n  Text,\n  type TextProps,\n  type TextStyle,\n  useWindowDimensions,\n  View,\n  type ViewProps,\n  type ViewStyle,\n} from \"react-native\"\nimport { StyleSheet } from \"react-native-unistyles\"\nimport { FocusScope } from \"../primitives/focus/index.js\"\nimport { DismissLayer } from \"../primitives/overlay/index.js\"\nimport { Portal } from \"../primitives/portal/index.js\"\nimport { composeEventHandlers } from \"../primitives/press/index.js\"\nimport { useScrollLock } from \"../primitives/scroll-lock/index.js\"\n\ntype DrawerContextValue = {\n  open: boolean\n  onOpenChange: (open: boolean) => void\n  triggerRef: React.RefObject<View | null>\n  contentRef: React.RefObject<View | null>\n  titleId: string\n  descriptionId: string\n  modal: boolean\n}\n\nconst DrawerContext = React.createContext<DrawerContextValue | undefined>(\n  undefined,\n)\n\nfunction useDrawer() {\n  const context = React.useContext(DrawerContext)\n  if (!context) {\n    throw new Error(\"Drawer components must be used within a Drawer\")\n  }\n  return context\n}\n\nexport type DrawerProps = {\n  children: React.ReactNode\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n  modal?: boolean\n}\n\nexport function Drawer({\n  children,\n  defaultOpen = false,\n  open: openProp,\n  onOpenChange,\n  modal = true,\n}: DrawerProps) {\n  const [open, setOpen] = React.useState(defaultOpen)\n  const triggerRef = React.useRef<View>(null)\n  const contentRef = React.useRef<View>(null)\n  const titleId = React.useId()\n  const descriptionId = React.useId()\n\n  const isControlled = openProp !== undefined\n  const isOpen = isControlled ? openProp : open\n\n  const handleOpenChange = React.useCallback(\n    (nextOpen: boolean) => {\n      if (!isControlled) {\n        setOpen(nextOpen)\n      }\n      onOpenChange?.(nextOpen)\n    },\n    [isControlled, onOpenChange],\n  )\n\n  return (\n    <DrawerContext.Provider\n      value={{\n        open: !!isOpen,\n        onOpenChange: handleOpenChange,\n        triggerRef,\n        contentRef,\n        titleId,\n        descriptionId,\n        modal,\n      }}\n    >\n      {children}\n    </DrawerContext.Provider>\n  )\n}\n\nexport type DrawerTriggerProps = PressableProps & { asChild?: boolean }\n\nexport const DrawerTrigger = React.forwardRef<\n  React.ComponentRef<typeof Pressable>,\n  DrawerTriggerProps\n>(({ children, asChild, onPress, disabled, ...props }, ref) => {\n  const { open, onOpenChange, triggerRef } = useDrawer()\n  const isDisabled = !!disabled\n\n  const handlePress = React.useCallback(\n    (event: unknown) => {\n      if (isDisabled) return\n      onOpenChange(!open)\n      // @ts-expect-error - React Native event type\n      onPress?.(event)\n    },\n    [isDisabled, open, onOpenChange, onPress],\n  )\n\n  React.useEffect(() => {\n    if (ref) {\n      if (typeof ref === \"function\") {\n        ref(triggerRef.current)\n      } else {\n        ;(ref as { current: View | null }).current = triggerRef.current\n      }\n    }\n  }, [ref, triggerRef])\n\n  if (asChild && React.isValidElement(children)) {\n    const child = children as React.ReactElement<{\n      onPress?: (event: unknown) => void\n    }>\n    const childOnPress = isDisabled ? undefined : child.props.onPress\n    // biome-ignore lint/suspicious/noExplicitAny: Cloning logic\n    return React.cloneElement(child as React.ReactElement<any>, {\n      ref: triggerRef,\n      onPress: composeEventHandlers(childOnPress, handlePress),\n      role: Platform.OS === \"web\" ? \"button\" : undefined,\n      \"aria-expanded\": Platform.OS === \"web\" ? open : undefined,\n      \"aria-haspopup\": Platform.OS === \"web\" ? \"dialog\" : undefined,\n      accessibilityRole: \"button\",\n      accessibilityState: {\n        expanded: open,\n        disabled: isDisabled,\n      },\n      disabled,\n      ...props,\n    })\n  }\n\n  return (\n    <Pressable\n      ref={triggerRef}\n      role={Platform.OS === \"web\" ? \"button\" : undefined}\n      aria-expanded={Platform.OS === \"web\" ? open : undefined}\n      aria-haspopup={Platform.OS === \"web\" ? \"dialog\" : undefined}\n      accessibilityRole=\"button\"\n      accessibilityState={{\n        expanded: open,\n        disabled: isDisabled,\n      }}\n      disabled={disabled}\n      onPress={handlePress}\n      {...props}\n    >\n      {children}\n    </Pressable>\n  )\n})\n\nDrawerTrigger.displayName = \"DrawerTrigger\"\n\nexport type DrawerCloseProps = PressableProps & { asChild?: boolean }\n\nexport const DrawerClose = React.forwardRef<\n  React.ComponentRef<typeof Pressable>,\n  DrawerCloseProps\n>(({ children, asChild, onPress, disabled, ...props }, ref) => {\n  const { onOpenChange } = useDrawer()\n  const isDisabled = !!disabled\n\n  const handlePress = React.useCallback(\n    (event: unknown) => {\n      if (isDisabled) return\n      onOpenChange(false)\n      // @ts-expect-error - React Native event type\n      onPress?.(event)\n    },\n    [isDisabled, onOpenChange, onPress],\n  )\n\n  if (asChild && React.isValidElement(children)) {\n    const child = children as React.ReactElement<{\n      onPress?: (event: unknown) => void\n    }>\n    const childOnPress = isDisabled ? undefined : child.props.onPress\n    // biome-ignore lint/suspicious/noExplicitAny: Cloning logic\n    return React.cloneElement(child as React.ReactElement<any>, {\n      ref,\n      onPress: composeEventHandlers(childOnPress, handlePress),\n      accessibilityRole: \"button\",\n      accessibilityState: {\n        disabled: isDisabled,\n      },\n      disabled,\n      ...props,\n    })\n  }\n\n  return (\n    <Pressable\n      ref={ref}\n      accessibilityRole=\"button\"\n      accessibilityState={{ disabled: isDisabled }}\n      disabled={disabled}\n      onPress={handlePress}\n      {...props}\n    >\n      {children}\n    </Pressable>\n  )\n})\n\nDrawerClose.displayName = \"DrawerClose\"\n\nexport type DrawerSide = \"bottom\" | \"left\" | \"right\" | \"top\"\n\nexport type DrawerContentProps = ViewProps & {\n  side?: DrawerSide\n  overlayStyle?: StyleProp<ViewStyle>\n  dismissable?: boolean\n  onDismiss?: () => void\n}\n\nexport const DrawerContent = React.forwardRef<View, DrawerContentProps>(\n  (\n    {\n      children,\n      style,\n      overlayStyle,\n      side = \"bottom\",\n      dismissable,\n      onDismiss,\n      ...props\n    },\n    ref,\n  ) => {\n    const {\n      open,\n      onOpenChange,\n      contentRef,\n      titleId,\n      descriptionId,\n      modal,\n    } = useDrawer()\n    const { width, height } = useWindowDimensions()\n    const translate = React.useRef(new Animated.Value(open ? 0 : 1)).current\n    const [mounted, setMounted] = React.useState(open)\n    const prevOpenRef = React.useRef(open)\n\n    React.useEffect(() => {\n      translate.stopAnimation()\n      const wasOpen = prevOpenRef.current\n\n      if (open && !wasOpen) {\n        setMounted(true)\n        translate.setValue(1)\n        Animated.timing(translate, {\n          toValue: 0,\n          duration: 250,\n          easing: Easing.out(Easing.cubic),\n          useNativeDriver: true,\n        }).start()\n      }\n\n      if (!open && wasOpen) {\n        Animated.timing(translate, {\n          toValue: 1,\n          duration: 200,\n          easing: Easing.in(Easing.cubic),\n          useNativeDriver: true,\n        }).start(({ finished }) => {\n          if (finished) {\n            setMounted(false)\n          }\n        })\n      }\n\n      prevOpenRef.current = open\n    }, [open, translate])\n\n    const isVisible = mounted\n    useScrollLock(isVisible && modal)\n    const variantStyles = styles.useVariants({\n      side,\n    }) as unknown\n    const contentVariantStyle =\n      variantStyles &&\n      typeof variantStyles === \"object\" &&\n      \"content\" in variantStyles\n        ? (variantStyles as typeof styles).content\n        : variantStyles\n\n    const handleDismiss = React.useCallback(() => {\n      onOpenChange(false)\n      onDismiss?.()\n    }, [onOpenChange, onDismiss])\n\n    const setContentRef = React.useCallback(\n      (node: View | null) => {\n        contentRef.current = node\n        if (typeof ref === \"function\") {\n          ref(node)\n        } else if (ref) {\n          ;(ref as { current: View | null }).current = node\n        }\n      },\n      [ref, contentRef],\n    )\n\n    const animatedStyle = React.useMemo(() => {\n      const distance =\n        side === \"left\" || side === \"right\" ? width : height\n      if (side === \"left\" || side === \"right\") {\n        const direction = side === \"left\" ? -1 : 1\n        return {\n          transform: [\n            {\n              translateX: translate.interpolate({\n                inputRange: [0, 1],\n                outputRange: [0, direction * distance],\n              }),\n            },\n          ],\n        }\n      }\n\n      const direction = side === \"top\" ? -1 : 1\n      return {\n        transform: [\n          {\n            translateY: translate.interpolate({\n              inputRange: [0, 1],\n              outputRange: [0, direction * distance],\n            }),\n          },\n        ],\n      }\n    }, [height, side, translate, width])\n\n    if (!isVisible) return null\n\n    const isDismissable = dismissable ?? modal\n\n    return (\n      <Portal>\n        <DismissLayer\n          onDismiss={handleDismiss}\n          dismissable={isDismissable}\n          scrim={modal}\n          scrimStyle={[styles.overlay, overlayStyle]}\n        >\n          <FocusScope trapped={modal} loop={true} style={styles.container}>\n            <Animated.View\n              ref={setContentRef}\n              role={Platform.OS === \"web\" ? \"dialog\" : undefined}\n              aria-modal={Platform.OS === \"web\" ? modal : undefined}\n              aria-labelledby={Platform.OS === \"web\" ? titleId : undefined}\n              aria-describedby={Platform.OS === \"web\" ? descriptionId : undefined}\n              accessibilityViewIsModal={modal}\n              style={\n                [\n                  styles.content,\n                  contentVariantStyle,\n                  animatedStyle,\n                  style,\n                  // biome-ignore lint/suspicious/noExplicitAny: Animated style arrays are dynamic.\n                ] as any\n              }\n              {...props}\n            >\n              {children}\n            </Animated.View>\n          </FocusScope>\n        </DismissLayer>\n      </Portal>\n    )\n  },\n)\n\nDrawerContent.displayName = \"DrawerContent\"\n\nexport type DrawerHeaderProps = ViewProps & {\n  style?: StyleProp<ViewStyle>\n}\n\nexport const DrawerHeader = React.forwardRef<View, DrawerHeaderProps>(\n  ({ style, ...props }, ref) => {\n    return <View ref={ref} style={[styles.header, style]} {...props} />\n  },\n)\n\nDrawerHeader.displayName = \"DrawerHeader\"\n\nexport type DrawerFooterProps = ViewProps & {\n  style?: StyleProp<ViewStyle>\n}\n\nexport const DrawerFooter = React.forwardRef<View, DrawerFooterProps>(\n  ({ style, ...props }, ref) => {\n    return <View ref={ref} style={[styles.footer, style]} {...props} />\n  },\n)\n\nDrawerFooter.displayName = \"DrawerFooter\"\n\nexport type DrawerTitleProps = TextProps & {\n  style?: StyleProp<TextStyle>\n}\n\nexport const DrawerTitle = React.forwardRef<Text, DrawerTitleProps>(\n  ({ style, ...props }, ref) => {\n    const { titleId } = useDrawer()\n    return (\n      <Text ref={ref} nativeID={titleId} style={[styles.title, style]} {...props} />\n    )\n  },\n)\n\nDrawerTitle.displayName = \"DrawerTitle\"\n\nexport type DrawerDescriptionProps = TextProps & {\n  style?: StyleProp<TextStyle>\n}\n\nexport const DrawerDescription = React.forwardRef<Text, DrawerDescriptionProps>(\n  ({ style, ...props }, ref) => {\n    const { descriptionId } = useDrawer()\n    return (\n      <Text\n        ref={ref}\n        nativeID={descriptionId}\n        style={[styles.description, style]}\n        {...props}\n      />\n    )\n  },\n)\n\nDrawerDescription.displayName = \"DrawerDescription\"\n\nconst styles = StyleSheet.create((theme) => ({\n  overlay: {\n    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n  },\n  container: {\n    flex: 1,\n  },\n  content: {\n    position: \"absolute\",\n    borderRadius: theme.radius.lg,\n    borderWidth: 1,\n    borderColor: theme.colors.border,\n    backgroundColor: theme.colors.background,\n    padding: theme.spacing[6],\n    shadowColor: theme.colors.foreground,\n    shadowOpacity: 0.15,\n    shadowRadius: 10,\n    elevation: 4,\n    variants: {\n      side: {\n        bottom: {\n          left: 0,\n          right: 0,\n          bottom: 0,\n          height: \"60%\",\n          maxHeight: 640,\n          borderBottomWidth: 0,\n          borderBottomLeftRadius: 0,\n          borderBottomRightRadius: 0,\n        },\n        top: {\n          left: 0,\n          right: 0,\n          top: 0,\n          height: \"60%\",\n          maxHeight: 640,\n          borderTopWidth: 0,\n          borderTopLeftRadius: 0,\n          borderTopRightRadius: 0,\n        },\n        right: {\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: \"80%\",\n          maxWidth: 480,\n          borderRightWidth: 0,\n          borderTopRightRadius: 0,\n          borderBottomRightRadius: 0,\n        },\n        left: {\n          top: 0,\n          bottom: 0,\n          left: 0,\n          width: \"80%\",\n          maxWidth: 480,\n          borderLeftWidth: 0,\n          borderTopLeftRadius: 0,\n          borderBottomLeftRadius: 0,\n        },\n      },\n    },\n  },\n  header: {\n    marginBottom: theme.spacing[4],\n    gap: theme.spacing[1],\n  },\n  footer: {\n    marginTop: theme.spacing[4],\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n    gap: theme.spacing[2],\n    flexWrap: \"wrap\",\n  },\n  title: {\n    color: theme.colors.foreground,\n    fontFamily: theme.typography.families.sans,\n    fontSize: theme.typography.sizes.lg,\n    lineHeight: theme.typography.lineHeights.lg,\n    fontWeight: theme.typography.weights.semibold,\n  },\n  description: {\n    color: theme.colors.mutedForeground,\n    fontFamily: theme.typography.families.sans,\n    fontSize: theme.typography.sizes.sm,\n    lineHeight: theme.typography.lineHeights.md,\n  },\n}))\n",
      "type": "registry:ui"
    }
  ]
}
