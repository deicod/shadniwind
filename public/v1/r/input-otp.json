{
  "name": "input-otp",
  "type": "registry:ui",
  "title": "Input OTP",
  "description": "One-time password input with auto-complete, paste support, and separator patterns",
  "dependencies": [
    "react-native-unistyles"
  ],
  "registryDependencies": [
    "tokens",
    "roving-focus"
  ],
  "files": [
    {
      "path": "components/ui/input-otp.tsx",
      "content": "import * as React from \"react\"\nimport {\n  Platform,\n  Pressable,\n  Text,\n  TextInput,\n  type ViewStyle,\n  View,\n} from \"react-native\"\nimport { StyleSheet, useUnistyles } from \"react-native-unistyles\"\nimport { composeRefs } from \"../primitives/roving-focus/utils.js\"\nimport type { InputOTPProps } from \"./input-otp.types.js\"\n\nconst DEFAULT_LENGTH = 6\nconst DEFAULT_PLACEHOLDER = \"\"\n\nconst styles = StyleSheet.create((theme) => ({\n  container: {\n    flexDirection: \"row\",\n    gap: theme.spacing[2],\n    alignItems: \"center\",\n  },\n  slot: {\n    width: theme.spacing[10],\n    height: theme.spacing[10],\n    borderRadius: theme.radius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.input,\n    backgroundColor: theme.colors.background,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    variants: {\n      focused: {\n        true: {\n          borderColor: theme.colors.ring,\n          shadowColor: theme.colors.ring,\n          shadowOpacity: 0.35,\n          shadowRadius: 4,\n          shadowOffset: { width: 0, height: 0 },\n        },\n      },\n      filled: {\n        true: {\n          backgroundColor: theme.colors.muted,\n        },\n      },\n      disabled: {\n        true: {\n          opacity: 0.5,\n        },\n      },\n    },\n  },\n  slotText: {\n    fontSize: theme.typography.sizes.lg,\n    fontWeight: theme.typography.weights.bold,\n    color: theme.colors.foreground,\n    fontFamily: theme.typography.families.mono,\n    textAlign: \"center\",\n  },\n  separator: {\n    color: theme.colors.mutedForeground,\n    fontSize: theme.typography.sizes.lg,\n    fontWeight: theme.typography.weights.bold,\n    paddingHorizontal: theme.spacing[1],\n  },\n  hiddenInput: {\n    position: \"absolute\",\n    opacity: 0,\n    width: 1,\n    height: 1,\n  },\n}))\n\nfunction resolveSlotStyle(\n  theme: ReturnType<typeof useUnistyles>[\"theme\"],\n  isFilled: boolean,\n  isFocused: boolean,\n  isDisabled: boolean,\n): ViewStyle {\n  const base: ViewStyle = {\n    width: theme.spacing[10],\n    height: theme.spacing[10],\n    borderRadius: theme.radius.md,\n    borderWidth: 1,\n    borderColor: theme.colors.input,\n    backgroundColor: theme.colors.background,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  }\n\n  if (isFilled) {\n    base.backgroundColor = theme.colors.muted\n  }\n\n  if (isFocused) {\n    base.borderColor = theme.colors.ring\n    base.shadowColor = theme.colors.ring\n    base.shadowOpacity = 0.35\n    base.shadowRadius = 4\n    base.shadowOffset = { width: 0, height: 0 }\n  }\n\n  if (isDisabled) {\n    base.opacity = 0.5\n  }\n\n  return base\n}\n\nexport const InputOTP = React.forwardRef<\n  React.ComponentRef<typeof TextInput>,\n  InputOTPProps\n>(\n  (\n    {\n      length = DEFAULT_LENGTH,\n      autoComplete = true,\n      value: valueProp,\n      defaultValue,\n      onChangeText,\n      disabled = false,\n      placeholder = DEFAULT_PLACEHOLDER,\n      separator = null,\n      style,\n      slotStyle,\n      textStyle,\n      ...props\n    },\n    ref,\n  ) => {\n    const { theme } = useUnistyles()\n    const [value, setValue] = React.useState(defaultValue ?? \"\")\n    const [focusedIndex, setFocusedIndex] = React.useState<number | null>(null)\n    const [caretIndex, setCaretIndex] = React.useState(0)\n    const isControlled = valueProp !== undefined\n    const currentValue = isControlled ? valueProp : value\n    const inputRef = React.useRef<TextInput>(null)\n    const composedRef = composeRefs(ref, inputRef)\n\n    const cleanValue = React.useCallback(\n      (val: string): string => {\n        let normalized = val\n        if (separator) {\n          normalized = normalized.replace(\n            new RegExp(separator.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"), \"g\"),\n            \"\",\n          )\n        }\n        return normalized.replace(/\\D/g, \"\").slice(0, length)\n      },\n      [length, separator],\n    )\n\n    const handleChangeText = React.useCallback(\n      (text: string) => {\n        const normalized = cleanValue(text)\n\n        if (!isControlled) {\n          setValue(normalized)\n        }\n        onChangeText?.(normalized)\n\n        setCaretIndex(Math.min(normalized.length, length))\n\n        if (Platform.OS === \"web\" && normalized.length > 0) {\n          const nextIndex = Math.min(normalized.length, length - 1)\n          setFocusedIndex(nextIndex)\n        }\n      },\n      [cleanValue, length, isControlled, onChangeText],\n    )\n\n    const handleSlotPress = React.useCallback(\n      (index: number) => {\n        if (disabled) return\n        setFocusedIndex(index)\n        setCaretIndex(index)\n        inputRef.current?.focus()\n      },\n      [disabled],\n    )\n\n    const handleKeyDown = React.useCallback(\n      // biome-ignore lint/suspicious/noExplicitAny: Web keyboard event\n      (event: any) => {\n        if (Platform.OS !== \"web\") return\n\n        if (event.key === \"Backspace\") {\n          if (\n            currentValue.length === 0 ||\n            focusedIndex === currentValue.length\n          ) {\n            const prevIndex = Math.max(\n              0,\n              (focusedIndex ?? currentValue.length) - 1,\n            )\n            setFocusedIndex(prevIndex)\n            setCaretIndex(prevIndex)\n          } else if (caretIndex > 0) {\n            setCaretIndex(caretIndex - 1)\n          }\n        } else if (event.key === \"ArrowLeft\") {\n          const newIndex = Math.max(\n            0,\n            (focusedIndex ?? currentValue.length) - 1,\n          )\n          setFocusedIndex(newIndex)\n          setCaretIndex(newIndex)\n        } else if (event.key === \"ArrowRight\") {\n          const newIndex = Math.min(length - 1, (focusedIndex ?? -1) + 1)\n          setFocusedIndex(newIndex)\n          setCaretIndex(newIndex)\n        }\n      },\n      [currentValue, focusedIndex, length, caretIndex],\n    )\n\n    const handlePaste = React.useCallback(\n      // biome-ignore lint/suspicious/noExplicitAny: Web clipboard event\n      (event: any) => {\n        if (Platform.OS !== \"web\") return\n\n        event.preventDefault()\n        const pastedData = event.clipboardData?.getData(\"text\") ?? \"\"\n        handleChangeText(pastedData)\n      },\n      [handleChangeText],\n    )\n\n    const isDisabled = disabled\n    const renderedValue = cleanValue(currentValue)\n\n    styles.useVariants({\n      disabled: isDisabled,\n    })\n\n    const slotIds = React.useMemo(\n      () => Array.from({ length }, (_, i) => `otp-slot-${i}`),\n      [length],\n    )\n\n    const separatorIndex = separator ? Math.floor(length / 2) : -1\n\n    const renderContent = () => {\n      const elements: React.ReactNode[] = []\n\n      slotIds.forEach((key, i) => {\n        if (separator && i === separatorIndex) {\n          elements.push(\n            <Text key=\"separator\" style={styles.separator}>\n              {separator}\n            </Text>,\n          )\n        }\n\n        const isFilled = i < renderedValue.length\n        const isFocused =\n          i === focusedIndex ||\n          (focusedIndex === null && i === renderedValue.length)\n        const char = renderedValue[i] ?? \"\"\n\n        elements.push(\n          <Pressable\n            key={key}\n            style={[\n              styles.slot,\n              resolveSlotStyle(theme, isFilled, isFocused, isDisabled),\n              slotStyle,\n            ]}\n            onPress={() => handleSlotPress(i)}\n            accessible={true}\n            accessibilityRole={Platform.OS === \"web\" ? \"button\" : undefined}\n            accessibilityLabel={`OTP digit ${i + 1} of ${length}`}\n            accessibilityState={{ disabled: isDisabled }}\n            disabled={isDisabled}\n          >\n            <Text style={[styles.slotText, textStyle]}>\n              {char || placeholder}\n            </Text>\n          </Pressable>,\n        )\n      })\n\n      return elements\n    }\n\n    return (\n      <View style={[styles.container, style]} {...props}>\n        {renderContent()}\n        <TextInput\n          ref={composedRef}\n          style={styles.hiddenInput}\n          value={renderedValue}\n          onChangeText={handleChangeText}\n          // @ts-expect-error - onKeyDown is web-only\n          onKeyDown={Platform.OS === \"web\" ? handleKeyDown : undefined}\n          onPaste={Platform.OS === \"web\" ? handlePaste : undefined}\n          maxLength={length}\n          editable={!isDisabled}\n          selection={{ start: caretIndex, end: caretIndex }}\n          {...Platform.select({\n            web: {\n              disabled: isDisabled,\n              autoComplete: autoComplete ? \"one-time-code\" : \"off\",\n            },\n            ios: { textContentType: autoComplete ? \"oneTimeCode\" : \"none\" },\n            android: { textContentType: autoComplete ? \"oneTimeCode\" : \"none\" },\n          })}\n          keyboardType=\"numeric\"\n          inputMode=\"numeric\"\n          selectTextOnFocus={false}\n        />\n      </View>\n    )\n  },\n)\n\nInputOTP.displayName = \"InputOTP\"\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/input-otp.web.tsx",
      "content": "export { InputOTP as default } from \"./input-otp.js\"\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/input-otp.native.tsx",
      "content": "export { InputOTP as default } from \"./input-otp.js\"\n",
      "type": "registry:ui"
    },
    {
      "path": "components/ui/input-otp.types.ts",
      "content": "import type { StyleProp, TextStyle, ViewStyle } from \"react-native\"\n\nexport type InputOTPProps = {\n  /** Number of OTP digits (default: 6) */\n  length?: number\n  /** Enable autoComplete for one-time-code (default: true) */\n  autoComplete?: boolean\n  /** Controlled value */\n  value?: string\n  /** Uncontrolled initial value */\n  defaultValue?: string\n  /** Called when OTP value changes */\n  onChangeText?: (value: string) => void\n  /** Disabled state */\n  disabled?: boolean\n  /** Placeholder character for empty slots (default: \"\") */\n  placeholder?: string\n  /** Separator pattern - e.g., \"-\" for \"123-456\" (default: null) */\n  separator?: string | null\n  /** Container style */\n  style?: StyleProp<ViewStyle>\n  /** Slot style override */\n  slotStyle?: StyleProp<ViewStyle>\n  /** Text style override */\n  textStyle?: StyleProp<TextStyle>\n}\n",
      "type": "registry:ui"
    }
  ]
}
